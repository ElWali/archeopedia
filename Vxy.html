<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archaeology Morocco</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom Scrollbar Styling (Tailwind doesn't natively support full scrollbar customization) */
        .custom-scrollbar::-webkit-scrollbar {
          width: 8px;
          height: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: #f1f1f1;
          border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: #888;
          border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: #555;
        }
        /* For Firefox */
        .custom-scrollbar {
          scrollbar-width: thin;
          scrollbar-color: #888 #f1f1f1;
        }
    </style>

    <!-- Leaflet CSS CDN -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        xintegrity="sha512-xodw+1+bfJcGEjCjRzDq4s+U2zW/2pT4r+j3q3L9Q+D+1O2o5o3z5s5d5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5b5L+    <!-- React and ReactDOM CDNs (Production versions) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel Standalone CDN - for in-browser JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Leaflet JS CDN -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        xintegrity="sha512-XQoYMqMTK8LvdxXYG3nZ4T8zL/y6M08+c5z5z5z5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5r=" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- Leaflet JavaScript CDN -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        xintegrity="sha512-XQoYMqMTK8LvdxXYG3nZ4T8zL/y6M08+c5z5z5z5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5d5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5v5
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { Map: LeafletMap, TileLayer, Marker, Popup } = window.L; // Access Leaflet objects globally

        // Ensure Leaflet's default icon paths are correctly set AFTER Leaflet loads
        // This is a common fix for marker display issues in certain environments.
        if (window.L && window.L.Icon && window.L.Icon.Default) {
            delete window.L.Icon.Default.prototype._getIconUrl;
            window.L.Icon.Default.mergeOptions({
                iconRetinaUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png',
                iconUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png',
                shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',
            });
        }


        function App() {
            const [sites, setSites] = useState([]);
            const [filteredSites, setFilteredSites] = useState([]);
            const [selectedSite, setSelectedSite] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [loading, setLoading] = useState(true); // New loading state
            const [error, setError] = useState(null); // New error state
            const mapRef = useRef(null); // Ref to hold the map instance
            const markersRef = useRef([]); // Ref to hold Leaflet markers

            // Access Leaflet globally
            const L = window.L;

            useEffect(() => {
                const fetchData = async () => {
                    try {
                        setLoading(true);
                        // Fetch from '/data/data.json' relative to where the HTML file is served
                        const response = await fetch('/data/output.json');
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        const data = await response.json();
                        // Filter for Morocco data
                        const moroccoSites = data.filter(site => site.country === 'Morocco');
                        setSites(moroccoSites);
                        setFilteredSites(moroccoSites);
                    } catch (e) {
                        console.error("Failed to fetch archaeological data:", e);
                        setError("Failed to load archaeological data. Please ensure '/data/data.json' is accessible and correctly formatted.");
                    } finally {
                        setLoading(false);
                    }
                };

                fetchData();
            }, []);

            useEffect(() => {
                // Initialize map only once if Leaflet is available and sites are loaded
                if (L && !mapRef.current && filteredSites.length > 0) {
                    const map = L.map('map').setView([31.7917, -7.0926], 6); // Centered on Morocco
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                    }).addTo(map);
                    mapRef.current = map;
                }

                // Clear existing markers
                markersRef.current.forEach(marker => {
                    if (mapRef.current && mapRef.current.hasLayer(marker)) {
                        marker.remove();
                    }
                });
                markersRef.current = [];

                // Add new markers for filtered sites
                if (mapRef.current && L) {
                    filteredSites.forEach(site => {
                        const marker = L.marker([site.latitude, site.longitude])
                            .addTo(mapRef.current)
                            .bindPopup(`<b>${site.site_name}</b><br>${site.site_type}`);

                        marker.on('click', () => {
                            setSelectedSite(site);
                            mapRef.current.setView([site.latitude, site.longitude], 10); // Zoom in on selected site
                        });
                        markersRef.current.push(marker);
                    });
                }
            }, [filteredSites, L]); // Add L as a dependency to ensure it's available

            const handleSearch = (event) => {
                const term = event.target.value.toLowerCase();
                setSearchTerm(term);
                const newFilteredSites = sites.filter(site =>
                    site.site_name.toLowerCase().includes(term) ||
                    site.description.toLowerCase().includes(term) ||
                    site.site_type.toLowerCase().includes(term) ||
                    site.period.toLowerCase().includes(term)
                );
                setFilteredSites(newFilteredSites);
            };

            const closeSiteDetail = () => {
                setSelectedSite(null);
            };

            if (loading) {
                return (
                    <div className="min-h-screen bg-gray-100 flex items-center justify-center">
                        <div className="flex flex-col items-center">
                            <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mb-4"></div>
                            <p className="text-gray-700 text-lg">Loading archaeological data...</p>
                        </div>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="min-h-screen bg-red-100 flex items-center justify-center">
                        <div className="text-red-800 text-center p-6 rounded-lg shadow-md bg-white">
                            <h2 className="text-xl font-bold mb-4">Error!</h2>
                            <p>{error}</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gray-100 flex flex-col">
                    <header className="bg-blue-800 text-white p-4 shadow-md">
                        <div className="container mx-auto flex justify-between items-center">
                            <h1 className="text-2xl font-bold">Archaeology Morocco</h1>
                            <nav>
                                <ul className="flex space-x-4">
                                    <li><a href="#" className="hover:text-blue-200">Home</a></li>
                                    <li><a href="#" className="hover:text-blue-200">About</a></li>
                                    <li><a href="#" className="hover:text-blue-200">Contribute</a></li>
                                </ul>
                            </nav>
                        </div>
                    </header>

                    <main className="flex flex-1 flex-col lg:flex-row p-4 gap-4 container mx-auto">
                        <div className="lg:w-1/3 w-full bg-white rounded-lg shadow-lg p-6 flex flex-col">
                            <h2 className="text-xl font-semibold text-gray-800 mb-4">Archaeological Sites in Morocco</h2>
                            <input
                                type="text"
                                placeholder="Search sites by name, type, or period..."
                                className="p-3 border border-gray-300 rounded-md mb-4 focus:ring-blue-500 focus:border-blue-500"
                                value={searchTerm}
                                onChange={handleSearch}
                            />
                            <div className="flex-1 overflow-y-auto pr-2 custom-scrollbar">
                                {filteredSites.length > 0 ? (
                                    filteredSites.map(site => (
                                        <div
                                            key={site.id}
                                            className={`p-4 mb-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-blue-50 transition-colors duration-200 ease-in-out
                                                ${selectedSite && selectedSite.id === site.id ? 'border-l-4 border-blue-500 bg-blue-100' : ''}`}
                                            onClick={() => setSelectedSite(site)}
                                        >
                                            <h3 className="text-lg font-medium text-gray-900">{site.site_name}</h3>
                                            <p className="text-sm text-gray-600">{site.site_type} - {site.period}</p>
                                        </div>
                                    ))
                                ) : (
                                    <p className="text-gray-500">No sites found matching your search.</p>
                                )}
                            </div>
                        </div>

                        <div className="lg:w-2/3 w-full flex flex-col gap-4">
                            <div id="map" className="w-full h-96 lg:h-2/3 bg-gray-200 rounded-lg shadow-lg" style={{ minHeight: '300px' }}></div>

                            {selectedSite && (
                                <div className="bg-white rounded-lg shadow-lg p-6 relative flex-1 overflow-y-auto custom-scrollbar">
                                    <button
                                        onClick={closeSiteDetail}
                                        className="absolute top-4 right-4 text-gray-600 hover:text-gray-900 focus:outline-none"
                                    >
                                        <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12" />
                                        </svg>
                                    </button>
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">{selectedSite.site_name}</h2>
                                    <div className="flex flex-col md:flex-row gap-4 mb-4">
                                        <img
                                            src={selectedSite.image_url}
                                            alt={`Image of ${selectedSite.site_name}`}
                                            className="rounded-lg object-cover w-full md:w-1/2 h-48 md:h-auto"
                                            onError={(e) => { e.target.onerror = null; e.target.src = "https://placehold.co/400x250/E0F2FE/2C5282?text=Image+Not+Available"; }}
                                        />
                                        <div className="md:w-1/2">
                                            <p className="text-gray-700 mb-2"><strong>Type:</strong> {selectedSite.site_type}</p>
                                            <p className="text-gray-700 mb-2"><strong>Period:</strong> {selectedSite.period}</p>
                                            <p className="text-gray-700 mb-2"><strong>Coordinates:</strong> {selectedSite.latitude.toFixed(3)}, {selectedSite.longitude.toFixed(3)}</p>
                                            <p className="text-gray-700 mb-2"><strong>Country:</strong> {selectedSite.country}</p>
                                            <p className="text-gray-700 mb-2"><strong>Main Reference:</strong> {selectedSite.main_reference}</p>
                                        </div>
                                    </div>
                                    <p className="text-gray-800 mb-4">{selectedSite.description}</p>

                                    {selectedSite.chronometric_data && selectedSite.chronometric_data.length > 0 && (
                                        <>
                                            <h3 className="text-xl font-semibold text-gray-800 mb-3">Chronometric Data</h3>
                                            <div className="space-y-3">
                                                {selectedSite.chronometric_data.map((data, index) => (
                                                    <div key={index} className="bg-gray-50 p-4 rounded-md border border-gray-200">
                                                        <p className="font-medium text-gray-900">Type: {data.type}</p>
                                                        {data.type === 'Radiocarbon' && (
                                                            <>
                                                                <p className="text-sm text-gray-700">BP: {data.bp} &plusmn; {data.std_dev}</p>
                                                                <p className="text-sm text-gray-700">Material: {data.material}</p>
                                                                <p className="text-sm text-gray-700">Species: {data.species}</p>
                                                                <p className="text-sm text-gray-700">Lab No.: {data.labnr}</p>
                                                            </>
                                                        )}
                                                        {data.type === 'Typological' && (
                                                            <p className="text-sm text-gray-700">Period: {data.period}</p>
                                                        )}
                                                         {data.type === 'Dendrochronology' && (
                                                            <p className="text-sm text-gray-700">Estimated Period: {data.period}</p>
                                                        )}
                                                        <p className="text-sm text-gray-700 italic">Reference: {data.reference}</p>
                                                    </div>
                                                ))}
                                            </div>
                                        </>
                                    )}
                                </div>
                            )}
                        </div>
                    </main>

                    <footer className="bg-gray-800 text-white p-4 text-center mt-4">
                        <div className="container mx-auto">
                            <p>&copy; 2024 Archaeology Morocco. Open Source Initiative.</p>
                        </div>
                    </footer>
                </div>
            );
        }

        // Mount the React App to the 'root' div
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
