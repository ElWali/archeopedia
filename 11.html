<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Archeopedia - ØªØ¬Ø±Ø¨Ø© Ø«Ù„Ø§Ø«ÙŠØ© Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Leaflet CSS Ù„Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ© -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <style>
    body, html {height:100%;margin:0;font-family:'Tajawal',Arial,sans-serif;background:radial-gradient(ellipse at top,#6a9fcf 0%,#181c24 100%);}
    #map {width:100vw;height:100vh;z-index:2;}
    #three3d {width:100vw;height:100vh;position:absolute;top:0;left:0;z-index:3;display:none;}
    #controlBar {position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:rgba(30,34,44,0.80);border-radius:18px;padding:8px 24px;box-shadow:0 8px 24px rgba(0,0,0,0.22);display:flex;gap:24px;z-index:99999;}
    #controlBar button {background:none;border:none;color:#fff;font-size:1.18em;cursor:pointer;transition:color 0.2s;padding:5px 12px;}
    #controlBar button:hover {color:#4ad1ff;}
  </style>
</head>
<body dir="rtl">
  <div id="map"></div>
  <div id="three3d"></div>

  <div id="controlBar">
    <button id="homeBtn">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    <button id="threeBtn">ğŸ—» Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ (Three.js)</button>
  </div>

  <!-- Leaflet JS Ù„Ù„Ø®Ø±ÙŠØ·Ø© -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <!-- Three.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
  <!-- FontLoader Ù…Ù† Ø£Ù…Ø«Ù„Ø© Three.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/examples/jsm/loaders/FontLoader.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/examples/jsm/geometries/TextGeometry.js"></script>
  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø±ÙŠØ·Ø© Leaflet
    const map = L.map('map', {zoomControl:false,minZoom:2,maxZoom:15,attributionControl:false})
      .setView([30.7, 34.8], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {detectRetina:true,maxZoom:18}).addTo(map);

    // Ø²Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø±ÙŠØ·Ø© ÙˆØ¥Ø®ÙØ§Ø¡ 3D
    document.getElementById('homeBtn').onclick = function(){
      document.getElementById('three3d').style.display = 'none';
      document.getElementById('map').style.display = 'block';
    };

    // Ø²Ø± Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯: Ø¹Ø±Ø¶ Three.js ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
    document.getElementById('threeBtn').onclick = function() {
      document.getElementById('map').style.display = 'none';
      document.getElementById('three3d').style.display = 'block';
      startThreeJS();
    };

    // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
    function startThreeJS() {
      // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¹Ù†ØµØ± Ø£ÙˆÙ„Ù‹Ø§
      document.getElementById('three3d').innerHTML = '';

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø´Ù‡Ø¯ ÙˆØ§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙˆØ§Ù„Ù…Ø¬Ø³Ù…
      const scene = new THREE.Scene();
      scene.background = new THREE.Color(0x181c24);

      const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
      camera.position.z = 4;

      const renderer = new THREE.WebGLRenderer({antialias:true});
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.getElementById('three3d').appendChild(renderer.domElement);

      // Ø¥Ø¶Ø§Ø¡Ø©
      const light = new THREE.DirectionalLight(0xffffff, 1);
      light.position.set(5,5,5).normalize();
      scene.add(light);

      // Ù…Ø¬Ø³Ù… Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ (Ù…ÙƒØ¹Ø¨)
      const geometry = new THREE.BoxGeometry();
      const material = new THREE.MeshStandardMaterial({ color: 0x307fff });
      const cube = new THREE.Mesh(geometry, material);
      scene.add(cube);

      // Ù†Øµ ØªÙˆØ¶ÙŠØ­ÙŠ Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
      const fontLoader = new THREE.FontLoader();
      fontLoader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function(font) {
        const textGeo = new THREE.TextGeometry('Archeopedia 3D', {
            font: font,
            size: 0.4,
            height: 0.05
        });
        const textMaterial = new THREE.MeshStandardMaterial({ color: 0xffffff });
        const textMesh = new THREE.Mesh(textGeo, textMaterial);
        textMesh.position.set(-1.4, -1.5, 0);
        scene.add(textMesh);
      });

      // Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø´Ø§Ø´Ø©
      window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth/window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });

      // Ø­Ø±ÙƒØ© Ø§Ù„Ù…ÙƒØ¹Ø¨
      function animate() {
        requestAnimationFrame(animate);
        cube.rotation.x += 0.01;
        cube.rotation.y += 0.01;
        renderer.render(scene, camera);
      }
      animate();
    }
  </script>
</body>
</html>
