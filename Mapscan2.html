<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <title>GeoAnalytics Studio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Montserrat:wght@600;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --primary: #1a73e8;
      --primary-dark: #1557b0;
      --secondary: #34a853;
      --accent: #fbbc05;
      --danger: #ea4335;
      --light: #f8f9fa;
      --dark: #0f1115;
      --darker: #06080c;
      --gray: #5f6368;
      --border: #dadce0;
      --shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
      --shadow-lg: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --radius: 12px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-fast: all 0.15s ease-in-out;
      --header-height: 64px;
      --sidebar-width: 320px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background: #0f1115;
      color: #e8eaed;
      min-height: 100vh;
      overflow: hidden;
    }

    header {
      background: linear-gradient(135deg, var(--darker) 0%, #1a1c20 100%);
      color: white;
      padding: 0 1.5rem;
      height: var(--header-height);
      box-shadow: var(--shadow-lg);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .header-content {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .logo {
      font-size: 1.5rem;
      font-weight: 700;
      color: white;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-family: 'Montserrat', sans-serif;
    }

    .logo-icon {
      color: var(--primary);
      font-size: 1.8rem;
    }

    .search-container {
      position: relative;
      width: 400px;
      max-width: 60%;
    }

    .search-box {
      width: 100%;
      padding: 0.6rem 1rem;
      padding-left: 36px;
      border-radius: 24px;
      border: 1px solid var(--border);
      background: rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 0.95rem;
      transition: var(--transition);
    }

    .search-box::placeholder {
      color: #9aa0a6;
    }

    .search-box:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.3);
      background: rgba(255, 255, 255, 0.15);
    }

    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #9aa0a6;
    }

    .header-icons {
      display: flex;
      gap: 0.8rem;
    }

    .icon-btn {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition-fast);
      font-size: 1.1rem;
    }

    .icon-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }

    .icon-btn.active {
      background: rgba(26, 115, 232, 0.3);
      color: var(--primary);
    }

    .container {
      display: flex;
      flex-direction: column;
      height: 100vh;
      margin-top: var(--header-height);
    }

    .main-content {
      display: flex;
      flex: 1;
    }

    .sidebar {
      width: var(--sidebar-width);
      background: linear-gradient(135deg, #1a1c20 0%, #0f1115 100%);
      border-right: 1px solid #2c2e32;
      padding: 1.5rem;
      overflow-y: auto;
      transition: var(--transition);
      position: relative;
    }

    .sidebar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid #2c2e32;
    }

    .sidebar-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: white;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .close-sidebar {
      background: none;
      border: none;
      color: #9aa0a6;
      cursor: pointer;
      font-size: 1.2rem;
      padding: 0.5rem;
      border-radius: 50%;
      transition: var(--transition-fast);
    }

    .close-sidebar:hover {
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .layer-list {
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
      margin-bottom: 1.5rem;
    }

    .layer-item {
      background: rgba(255, 255, 255, 0.08);
      border-radius: 8px;
      padding: 0.8rem 1rem;
      border: 1px solid #2c2e32;
      transition: var(--transition-fast);
      cursor: pointer;
    }

    .layer-item:hover {
      background: rgba(255, 255, 255, 0.12);
      border-color: var(--primary);
    }

    .layer-item.active {
      background: rgba(26, 115, 232, 0.2);
      border-color: var(--primary);
      box-shadow: 0 2px 8px rgba(26, 115, 232, 0.2);
    }

    .layer-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .layer-name {
      font-size: 0.95rem;
      color: white;
      font-weight: 500;
    }

    .layer-status {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #4285f4;
    }

    .layer-item.inactive .layer-status {
      background: #ea4335;
    }

    .analysis-panel {
      margin-top: 1.5rem;
      padding: 1.2rem;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 12px;
      border: 1px solid #2c2e32;
    }

    .panel-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: white;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .analysis-content {
      color: #9aa0a6;
      font-size: 0.9rem;
      line-height: 1.6;
    }

    .data-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.8rem;
      margin-top: 0.8rem;
    }

    .data-item {
      background: rgba(255, 255, 255, 0.05);
      padding: 0.6rem;
      border-radius: 6px;
      font-size: 0.85rem;
    }

    .data-label {
      color: #9aa0a6;
      margin-bottom: 0.3rem;
    }

    .data-value {
      color: white;
      font-weight: 500;
    }

    #map {
      flex: 1;
      position: relative;
    }

    .leaflet-container {
      background: #0f1115;
    }

    .leaflet-popup-content-wrapper {
      border-radius: 12px;
      box-shadow: var(--shadow-xl);
      overflow: hidden;
      background: linear-gradient(135deg, #1a1c20 0%, #0f1115 100%);
      border: 1px solid #2c2e32;
    }

    .popup-container {
      min-width: 400px;
      max-width: 500px;
      font-family: 'Roboto', sans-serif;
    }

    .popup-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: 1.2rem 1.5rem;
      border-radius: 12px 12px 0 0;
      margin: -1px -1px 0 -1px;
    }

    .popup-title {
      font-size: 1.3rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }

    .popup-subtitle {
      font-size: 0.9rem;
      opacity: 0.9;
      margin-top: 0.3rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    .popup-body {
      padding: 1.5rem;
      max-height: 600px;
      overflow-y: auto;
    }

    .data-section {
      margin-bottom: 1.5rem;
      padding-bottom: 1.2rem;
      border-bottom: 1px solid #2c2e32;
    }

    .data-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }

    .section-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }

    .data-item-detailed {
      margin-bottom: 0.8rem;
      padding: 0.8rem;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 8px;
      border: 1px solid #2c2e32;
      transition: var(--transition-fast);
    }

    .data-item-detailed:hover {
      background: rgba(255, 255, 255, 0.12);
      border-color: var(--primary);
      transform: translateX(6px);
    }

    .data-label-detailed {
      font-weight: 500;
      color: #9aa0a6;
      margin-bottom: 0.3rem;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    .data-value-detailed {
      color: white;
      font-size: 0.95rem;
      line-height: 1.5;
      padding-right: 1.5rem;
    }

    .data-value-detailed b {
      color: white;
      font-weight: 600;
    }

    .coordinates {
      display: flex;
      gap: 1.2rem;
      margin-bottom: 0.8rem;
    }

    .coord-item {
      flex: 1;
      background: rgba(26, 115, 232, 0.2);
      padding: 0.5rem;
      border-radius: 6px;
      font-size: 0.95rem;
      text-align: center;
      border: 1px solid rgba(26, 115, 232, 0.3);
      font-family: 'Roboto Mono', monospace;
      color: white;
    }

    .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 3rem 2rem;
      color: #9aa0a6;
      text-align: center;
    }

    .loading-spinner {
      width: 32px;
      height: 32px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-top: 4px solid var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 1rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .error {
      color: var(--danger);
      font-weight: 500;
      text-align: center;
      padding: 1.5rem;
      line-height: 1.6;
    }

    .popup-footer {
      text-align: center;
      padding: 1rem 1.5rem;
      background: rgba(255, 255, 255, 0.05);
      border-top: 1px solid #2c2e32;
      border-radius: 0 0 12px 12px;
      font-size: 0.85rem;
      color: #9aa0a6;
      display: flex;
      justify-content: space-between;
    }

    .action-buttons {
      display: flex;
      gap: 0.8rem;
      margin-top: 0.5rem;
    }

    .btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 6px;
      font-size: 0.85rem;
      cursor: pointer;
      transition: var(--transition-fast);
      font-weight: 500;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
    }

    .btn-outline {
      background: transparent;
      color: var(--primary);
      border: 1px solid var(--primary);
    }

    .btn-outline:hover {
      background: rgba(26, 115, 232, 0.1);
    }

    .scientific-tools {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 0.8rem;
      margin-top: 1rem;
    }

    .tool-card {
      background: rgba(255, 255, 255, 0.08);
      padding: 0.8rem;
      border-radius: 8px;
      border: 1px solid #2c2e32;
      text-align: center;
      transition: var(--transition-fast);
    }

    .tool-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border-color: var(--primary);
    }

    .tool-title {
      font-weight: 500;
      color: var(--primary);
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }

    .tool-value {
      font-size: 1.1rem;
      font-weight: 600;
      color: white;
    }

    .map-marker {
      background: white;
      width: 34px;
      height: 34px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      border: 2px solid var(--primary);
      position: relative;
    }

    .map-marker::after {
      content: '';
      width: 14px;
      height: 14px;
      background: var(--primary);
      border-radius: 50%;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.7; }
      100% { transform: scale(1); opacity: 1; }
    }

    .language-switcher {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
      color: #9aa0a6;
    }

    .language-option {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: #9aa0a6;
      padding: 0.3rem 0.6rem;
      border-radius: 4px;
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .language-option:hover {
      background: rgba(255, 255, 255, 0.2);
      color: white;
    }

    .language-option.active {
      background: var(--primary);
      color: white;
    }

    .fullscreen-btn {
      position: absolute;
      bottom: 20px;
      right: 20px;
      background: rgba(15, 17, 21, 0.8);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid #2c2e32;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition-fast);
      z-index: 1000;
    }

    .fullscreen-btn:hover {
      background: rgba(26, 115, 232, 0.3);
      border-color: var(--primary);
      transform: translateY(-2px);
    }

    .zoom-controls {
      position: absolute;
      bottom: 80px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 1000;
    }

    .zoom-btn {
      background: rgba(15, 17, 21, 0.8);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid #2c2e32;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition-fast);
      font-size: 1.2rem;
    }

    .zoom-btn:hover {
      background: rgba(26, 115, 232, 0.3);
      border-color: var(--primary);
    }

    .zoom-btn:active {
      transform: translateY(1px);
    }

    .compass {
      position: absolute;
      top: 20px;
      left: 20px;
      width: 50px;
      height: 50px;
      background: rgba(15, 17, 21, 0.8);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid #2c2e32;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition-fast);
      z-index: 1000;
    }

    .compass:hover {
      transform: rotate(360deg);
    }

    .compass::after {
      content: 'N';
      color: var(--primary);
      font-weight: bold;
    }

    @media (max-width: 1024px) {
      .search-container {
        width: 300px;
      }
      
      .sidebar {
        width: 280px;
      }
    }

    @media (max-width: 768px) {
      :root {
        --sidebar-width: 280px;
      }
      
      .search-container {
        width: 200px;
      }
      
      .header-content {
        gap: 0.5rem;
      }
      
      .logo {
        font-size: 1.3rem;
      }
      
      .popup-container {
        min-width: 320px;
        max-width: 100%;
      }
      
      .coordinates {
        flex-direction: column;
      }
      
      .scientific-tools {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 480px) {
      :root {
        --sidebar-width: 100%;
        --header-height: 56px;
      }
      
      header {
        padding: 0 1rem;
        height: var(--header-height);
      }
      
      .search-container {
        width: 120px;
      }
      
      .logo {
        font-size: 1.2rem;
      }
      
      .sidebar {
        position: fixed;
        top: var(--header-height);
        left: -100%;
        height: calc(100vh - var(--header-height));
        z-index: 1500;
        transform: translateX(0);
        transition: transform 0.3s ease-out;
      }
      
      .sidebar.open {
        transform: translateX(0);
      }
      
      .sidebar-header {
        padding-bottom: 0.8rem;
      }
      
      .main-content {
        flex-direction: column;
      }
      
      #map {
        flex: 1;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <div class="logo">
        <span class="logo-icon">ğŸŒ</span>
        GeoAnalytics Studio
      </div>
      <div class="search-container">
        <span class="search-icon">ğŸ”</span>
        <input type="text" class="search-box" placeholder="Search for places, coordinates..." id="searchInput">
      </div>
    </div>
    <div class="header-icons">
      <button class="icon-btn" title="Layers" id="layersBtn">
        <i>ğŸ¨</i>
      </button>
      <button class="icon-btn" title="Analysis" id="analysisBtn">
        <i>ğŸ“Š</i>
      </button>
      <div class="language-switcher">
        <button class="language-option active" data-lang="en">EN</button>
        <button class="language-option" data-lang="ar">AR</button>
      </div>
      <button class="icon-btn" title="Account">
        <i>ğŸ‘¤</i>
      </button>
    </div>
  </header>

  <div class="container">
    <div class="main-content">
      <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <div class="sidebar-title">
            <i>ğŸ¨</i> Map Layers
          </div>
          <button class="close-sidebar" id="closeSidebar">Ã—</button>
        </div>
        <div class="layer-list">
          <div class="layer-item active">
            <div class="layer-info">
              <div class="layer-name">Satellite Imagery</div>
              <div class="layer-status"></div>
            </div>
          </div>
          <div class="layer-item">
            <div class="layer-info">
              <div class="layer-name">Topographic Map</div>
              <div class="layer-status inactive"></div>
            </div>
          </div>
          <div class="layer-item">
            <div class="layer-info">
              <div class="layer-name">Street Map</div>
              <div class="layer-status inactive"></div>
            </div>
          </div>
          <div class="layer-item">
            <div class="layer-info">
              <div class="layer-name">Terrain 3D</div>
              <div class="layer-status inactive"></div>
            </div>
          </div>
          <div class="layer-item">
            <div class="layer-info">
              <div class="layer-name">Weather Overlay</div>
              <div class="layer-status inactive"></div>
            </div>
          </div>
        </div>
        
        <div class="analysis-panel">
          <div class="panel-title">
            <i>ğŸ”¬</i> Spatial Analysis
          </div>
          <div class="analysis-content">
            Click on any location to perform advanced geospatial analysis using AI-powered algorithms.
          </div>
          <div class="data-grid">
            <div class="data-item">
              <div class="data-label">Elevation</div>
              <div class="data-value">-</div>
            </div>
            <div class="data-item">
              <div class="data-label">Distance to Coast</div>
              <div class="data-value">-</div>
            </div>
            <div class="data-item">
              <div class="data-label">Climate Zone</div>
              <div class="data-value">-</div>
            </div>
            <div class="data-item">
              <div class="data-label">Land Use</div>
              <div class="data-value">-</div>
            </div>
          </div>
        </div>
      </div>
      
      <div id="map"></div>
    </div>
  </div>

  <div class="compass">N</div>
  <div class="zoom-controls">
    <button class="zoom-btn" id="zoomIn">+</button>
    <button class="zoom-btn" id="zoomOut">-</button>
  </div>
  <button class="fullscreen-btn" id="fullscreenBtn">â›¶</button>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    // Language translations
    const translations = {
      en: {
        title: "GeoAnalytics Studio",
        searchPlaceholder: "Search for places, coordinates...",
        mapLayers: "Map Layers",
        spatialAnalysis: "Spatial Analysis",
        clickAnalysis: "Click on any location to perform advanced geospatial analysis using AI-powered algorithms.",
        elevation: "Elevation",
        distanceToCoast: "Distance to Coast",
        climateZone: "Climate Zone",
        landUse: "Land Use",
        coordinates: "Coordinates",
        altitude: "Altitude",
        timezone: "Timezone",
        environmentalAnalysis: "Environmental Analysis",
        climate: "Climate",
        vegetation: "Vegetation",
        waterResources: "Water Resources",
        soilType: "Soil Type",
        environmentalHazards: "Environmental Hazards",
        geographicalInfo: "Geographical Information",
        location: "Location",
        country: "Country",
        scientificAnalysis: "Scientific Analysis",
        estimatedTemperature: "Estimated Temperature",
        relativeHumidity: "Relative Humidity",
        sunlightExposure: "Sunlight Exposure",
        windSpeed: "Wind Speed",
        analysisComplete: "Analysis completed at",
        close: "Close",
        layers: "Layers",
        analysis: "Analysis",
        account: "Account"
      },
      ar: {
        title: "Ø³ØªÙˆØ¯ÙŠÙˆ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ",
        searchPlaceholder: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£Ù…Ø§ÙƒÙ†ØŒ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª...",
        mapLayers: "Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø®Ø±ÙŠØ·Ø©",
        spatialAnalysis: "Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙƒØ§Ù†ÙŠ",
        clickAnalysis: "Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£ÙŠ Ù…ÙˆÙ‚Ø¹ Ù„Ø£Ø¯Ø§Ø¡ ØªØ­Ù„ÙŠÙ„ Ø¬ØºØ±Ø§ÙÙŠ Ù…ØªÙ‚Ø¯Ù… Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ.",
        elevation: "Ø§Ù„Ø§Ø±ØªÙØ§Ø¹",
        distanceToCoast: "Ø§Ù„Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø³Ø§Ø­Ù„",
        climateZone: "Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ù†Ø§Ø®ÙŠØ©",
        landUse: "Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ",
        coordinates: "Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª",
        altitude: "Ø§Ù„Ø§Ø±ØªÙØ§Ø¹",
        timezone: "Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©",
        environmentalAnalysis: "Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ¦ÙŠ",
        climate: "Ø§Ù„Ù…Ù†Ø§Ø®",
        vegetation: "Ø§Ù„ØºØ·Ø§Ø¡ Ø§Ù„Ù†Ø¨Ø§ØªÙŠ",
        waterResources: "Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø§Ø¦ÙŠØ©",
        soilType: "Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø©",
        environmentalHazards: "Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø¨ÙŠØ¦ÙŠØ©",
        geographicalInfo: "Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©",
        location: "Ø§Ù„Ù…ÙˆÙ‚Ø¹",
        country: "Ø§Ù„Ø¯ÙˆÙ„Ø©",
        scientificAnalysis: "Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ù…ÙŠ",
        estimatedTemperature: "Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ù‚Ø¯Ø±Ø©",
        relativeHumidity: "Ø§Ù„Ø±Ø·ÙˆØ¨Ø© Ø§Ù„Ù†Ø³Ø¨ÙŠØ©",
        sunlightExposure: "Ø§Ù„ØªØ¹Ø±Ø¶ Ù„Ù„Ø´Ù…Ø³",
        windSpeed: "Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙŠØ§Ø­",
        analysisComplete: "Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙÙŠ",
        close: "Ø¥ØºÙ„Ø§Ù‚",
        layers: "Ø§Ù„Ø·Ø¨Ù‚Ø§Øª",
        analysis: "Ø§Ù„ØªØ­Ù„ÙŠÙ„",
        account: "Ø§Ù„Ø­Ø³Ø§Ø¨"
      }
    };

    // Current language
    let currentLang = 'en';

    // Function to update language
    function updateLanguage(lang) {
      currentLang = lang;
      document.querySelector('title').textContent = translations[lang].title;
      document.querySelector('.logo').innerHTML = `<span class="logo-icon">ğŸŒ</span> ${translations[lang].title}`;
      document.getElementById('searchInput').placeholder = translations[lang].searchPlaceholder;
      document.querySelector('.sidebar-title').innerHTML = `<i>ğŸ¨</i> ${translations[lang].mapLayers}`;
      document.querySelector('.panel-title').innerHTML = `<i>ğŸ”¬</i> ${translations[lang].spatialAnalysis}`;
      document.querySelector('.analysis-content').textContent = translations[lang].clickAnalysis;
      
      // Update data labels
      document.querySelector('.data-grid .data-item:nth-child(1) .data-label').textContent = translations[lang].elevation;
      document.querySelector('.data-grid .data-item:nth-child(2) .data-label').textContent = translations[lang].distanceToCoast;
      document.querySelector('.data-grid .data-item:nth-child(3) .data-label').textContent = translations[lang].climateZone;
      document.querySelector('.data-grid .data-item:nth-child(4) .data-label').textContent = translations[lang].landUse;

      // Update header tooltips
      document.getElementById('layersBtn').title = translations[lang].layers;
      document.getElementById('analysisBtn').title = translations[lang].analysis;
      document.querySelector('[title="Account"]').title = translations[lang].account;
    }

    // Initialize language
    updateLanguage('en');

    // Language switcher event listeners
    document.querySelectorAll('.language-option').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.language-option').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        updateLanguage(this.dataset.lang);
      });
    });

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø©
    const map = L.map('map', {
      zoomControl: false,
      attributionControl: false,
      center: [31.7917, -7.0926],
      zoom: 6,
      maxZoom: 19,
      minZoom: 3
    });

    // Ø¥Ø¶Ø§ÙØ© Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø®Ø±Ø§Ø¦Ø· Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
    const satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
      maxZoom: 19
    });

    const terrainLayer = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
      maxZoom: 17
    });

    const streetLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19
    });

    // Ø¬Ø¹Ù„ Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¬ÙˆÙŠØ© Ù‡ÙŠ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    satelliteLayer.addTo(map);

    // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª
    const layers = {
      "Satellite Imagery": satelliteLayer,
      "Topographic Map": terrainLayer,
      "Street Map": streetLayer
    };

    // Ø¥Ø¶Ø§ÙØ© Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ…
    document.getElementById('zoomIn').addEventListener('click', () => {
      map.zoomIn();
    });

    document.getElementById('zoomOut').addEventListener('click', () => {
      map.zoomOut();
    });

    document.getElementById('fullscreenBtn').addEventListener('click', () => {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(err => {
          console.log(`Error attempting to enable full-screen mode: ${err.message}`);
        });
      } else {
        if (document.exitFullscreen) {
          document.exitFullscreen();
        }
      }
    });

    // Compass functionality
    document.querySelector('.compass').addEventListener('click', () => {
      map.setView([31.7917, -7.0926], 6);
    });

    // Sidebar toggle
    document.getElementById('layersBtn').addEventListener('click', () => {
      document.getElementById('sidebar').classList.add('open');
    });

    document.getElementById('closeSidebar').addEventListener('click', () => {
      document.getElementById('sidebar').classList.remove('open');
    });

    // Layer selection
    document.querySelectorAll('.layer-item').forEach((item, index) => {
      item.addEventListener('click', function() {
        document.querySelectorAll('.layer-item').forEach(i => i.classList.remove('active'));
        this.classList.add('active');
        
        // Remove all layers
        Object.values(layers).forEach(layer => {
          map.removeLayer(layer);
        });
        
        // Add selected layer
        const layerName = this.querySelector('.layer-name').textContent;
        if (layers[layerName]) {
          layers[layerName].addTo(map);
        }
      });
    });

    // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ­ÙƒÙ…
    let lastMarker = null;
    let currentPopup = null;

    // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨ÙŠØ¦ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹
    function analyzeEnvironmentalConditions(elevation, lat, lng) {
      const conditions = {
        climate: '',
        vegetation: '',
        water: '',
        soil: '',
        hazards: []
      };

      // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ø® Ø­Ø³Ø¨ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ ÙˆØ®Ø· Ø§Ù„Ø¹Ø±Ø¶
      if (elevation < 100) {
        if (lat > 30) {
          conditions.climate = currentLang === 'en' ? 'Temperate coastal climate' : 'Ù…Ù†Ø§Ø® Ù…ØªÙˆØ³Ø· Ø³Ø§Ø­Ù„ÙŠ';
        } else {
          conditions.climate = currentLang === 'en' ? 'Tropical coastal climate' : 'Ù…Ù†Ø§Ø® Ø§Ø³ØªÙˆØ§Ø¦ÙŠ Ø³Ø§Ø­Ù„ÙŠ';
        }
      } else if (elevation < 500) {
        conditions.climate = currentLang === 'en' ? 'Moderate climate' : 'Ù…Ù†Ø§Ø® Ù…Ø¹ØªØ¯Ù„';
      } else if (elevation < 1500) {
        conditions.climate = currentLang === 'en' ? 'Cool moderate climate' : 'Ù…Ù†Ø§Ø® Ø¨Ø§Ø±Ø¯ Ù…Ø¹ØªØ¯Ù„';
      } else {
        conditions.climate = currentLang === 'en' ? 'Cold mountain climate' : 'Ù…Ù†Ø§Ø® Ø¬Ø¨Ù„ÙŠ Ø¨Ø§Ø±Ø¯';
      }

      // ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØºØ·Ø§Ø¡ Ø§Ù„Ù†Ø¨Ø§ØªÙŠ
      if (elevation < 200) {
        conditions.vegetation = currentLang === 'en' ? 'Agricultural lands and plains' : 'Ø£Ø±Ø§Ø¶ÙŠ Ø²Ø±Ø§Ø¹ÙŠØ© ÙˆØ³Ù‡ÙˆÙ„';
      } else if (elevation < 800) {
        conditions.vegetation = currentLang === 'en' ? 'Moderate forests' : 'ØºØ§Ø¨Ø§Øª Ù…Ø¹ØªØ¯Ù„Ø©';
      } else if (elevation < 1500) {
        conditions.vegetation = currentLang === 'en' ? 'Mountain forests' : 'ØºØ§Ø¨Ø§Øª Ø¬Ø¨Ù„ÙŠØ©';
      } else {
        conditions.vegetation = currentLang === 'en' ? 'Rocky areas and permanent snow' : 'Ø£Ø±Ø§Ø¶ÙŠ ØµØ®Ø±ÙŠØ© ÙˆØ«Ù„ÙˆØ¬ Ø¯Ø§Ø¦Ù…Ø©';
      }

      // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø§Ø¦ÙŠØ©
      if (elevation > 1000) {
        conditions.water = currentLang === 'en' ? 'Main source of groundwater' : 'Ù…ØµØ¯Ø± Ø±Ø¦ÙŠØ³ÙŠ Ù„Ù„Ù…ÙŠØ§Ù‡ Ø§Ù„Ø¬ÙˆÙÙŠØ©';
      } else if (elevation > 500) {
        conditions.water = currentLang === 'en' ? 'Seasonal mountain streams' : 'Ø¬Ø¯Ø§ÙˆÙ„ Ø¬Ø¨Ù„ÙŠØ© Ù…ÙˆØ³Ù…ÙŠØ©';
      } else {
        conditions.water = currentLang === 'en' ? 'Surface water sources' : 'Ù…ØµØ§Ø¯Ø± Ù…Ø§Ø¦ÙŠØ© Ø³Ø·Ø­ÙŠØ©';
      }

      // ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ±Ø¨Ø©
      if (elevation < 300) {
        conditions.soil = currentLang === 'en' ? 'Fertile soil suitable for agriculture' : 'ØªØ±Ø¨Ø© Ø®ØµØ¨Ø© Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø²Ø±Ø§Ø¹Ø©';
      } else if (elevation < 800) {
        conditions.soil = currentLang === 'en' ? 'Moderately fertile soil' : 'ØªØ±Ø¨Ø© Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ø®ØµÙˆØ¨Ø©';
      } else {
        conditions.soil = currentLang === 'en' ? 'Rocky soil with low fertility' : 'ØªØ±Ø¨Ø© ØµØ®Ø±ÙŠØ© Ø¶Ø¹ÙŠÙØ© Ø§Ù„Ø®ØµÙˆØ¨Ø©';
      }

      // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©
      if (elevation > 1500 && lat > 30) {
        conditions.hazards.push(currentLang === 'en' ? 'Snow avalanches' : 'Ø§Ù†Ø²Ù„Ø§Ù‚Ø§Øª Ø«Ù„Ø¬ÙŠØ©');
      }
      if (elevation < 50 && lng < 0) {
        conditions.hazards.push(currentLang === 'en' ? 'Coastal floods' : 'ÙÙŠØ¶Ø§Ù†Ø§Øª Ø³Ø§Ø­Ù„ÙŠØ©');
      }
      if (elevation > 1000) {
        conditions.hazards.push(currentLang === 'en' ? 'Difficult access' : 'ØµØ¹ÙˆØ¨Ø© Ø§Ù„ÙˆØµÙˆÙ„');
      }

      return conditions;
    }

    // Ø¯Ø§Ù„Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø¨Ø­Ø±
    function calculateDistanceToCoast(lat, lng) {
      // Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª ØªÙ…Ø«Ù„ Ø¨Ø¹Ø¶ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙÙŠ Ø§Ù„Ù…ØºØ±Ø¨
      const coastPoints = [
        [35.7744, -3.8657], // Ø·Ù†Ø¬Ø©
        [34.0388, -6.8199], // Ø§Ù„Ø¯Ø§Ø± Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡
        [32.2983, -9.2333], // Ø£ÙƒØ§Ø¯ÙŠØ±
        [27.9861, -15.6894] // Ø§Ù„Ø¹ÙŠÙˆÙ†
      ];

      let minDistance = Infinity;
      
      coastPoints.forEach(point => {
        const R = 6371; // Ù†ØµÙ Ù‚Ø·Ø± Ø§Ù„Ø£Ø±Ø¶ Ø¨Ø§Ù„ÙƒÙŠÙ„ÙˆÙ…ØªØ±
        const dLat = (point[0] - lat) * Math.PI / 180;
        const dLon = (point[1] - lng) * Math.PI / 180;
        const a = 
          Math.sin(dLat/2) * Math.sin(dLat/2) +
          Math.cos(lat * Math.PI / 180) * Math.cos(point[0] * Math.PI / 180) * 
          Math.sin(dLon/2) * Math.sin(dLon/2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        const distance = R * c;
        
        if (distance < minDistance) {
          minDistance = distance;
        }
      });

      return minDistance;
    }

    // ÙˆØ¸ÙŠÙØ© ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±
    map.on('click', async function (e) {
      const lat = e.latlng.lat.toFixed(6);
      const lng = e.latlng.lng.toFixed(6);
      const latNum = parseFloat(lat);
      const lngNum = parseFloat(lng);

      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø©
      if (currentPopup) {
        map.closePopup(currentPopup);
        currentPopup = null;
      }

      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª
      if (lastMarker) {
        map.removeLayer(lastMarker);
      }

      // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù„Ø§Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
      lastMarker = L.marker(e.latlng, {
        icon: L.divIcon({
          className: 'map-marker',
          iconSize: [34, 34],
          iconAnchor: [17, 17]
        })
      }).addTo(map);

      // Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙÙ‚Ø§Ø¹Ø© Ù…Ø¹ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
      const popup = L.popup({
        minWidth: 450,
        maxWidth: 550,
        autoClose: false,
        closeOnClick: false
      })
        .setLatLng(e.latlng)
        .setContent(`
          <div class="popup-container">
            <div class="popup-header">
              <div class="popup-title">ğŸ”¬ ${currentLang === 'en' ? 'Geospatial Analysis' : 'Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ'}</div>
              <div class="popup-subtitle">${currentLang === 'en' ? 'AI-powered spatial intelligence' : 'Ø°ÙƒØ§Ø¡ Ù…ÙƒØ§Ù†ÙŠ Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ'}</div>
            </div>
            <div class="popup-body">
              <div class="loading">
                <div class="loading-spinner"></div>
                <div>${currentLang === 'en' ? 'Analyzing geospatial data with AI algorithms...' : 'Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ...'}</div>
              </div>
            </div>
            <div class="popup-footer">
              <div>${currentLang === 'en' ? 'Real-time analysis' : 'ØªØ­Ù„ÙŠÙ„ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ'}</div>
              <div class="action-buttons">
                <button class="btn btn-outline">${currentLang === 'en' ? 'Close' : 'Ø¥ØºÙ„Ø§Ù‚'}</button>
              </div>
            </div>
          </div>
        `)
        .openOn(map);

      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø±Ø¬Ø¹ Ù„Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      currentPopup = popup;

      // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù… Ù…Ø¹ ØªØ£Ø®ÙŠØ±
      setTimeout(async () => {
        try {
          // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„Ø§Ø±ØªÙØ§Ø¹ (Ø¨Ø¯ÙŠÙ„ Ù„Ù€ elevation API)
          const elevation = Math.random() * 2000; // Ù‚ÙŠÙ…Ø© ÙˆÙ‡Ù…ÙŠØ© Ù„Ù„Ø§Ø±ØªÙØ§Ø¹
          const distanceToCoast = calculateDistanceToCoast(latNum, lngNum);
          const conditions = analyzeEnvironmentalConditions(elevation, latNum, lngNum);

          // ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
          document.querySelector('.data-grid .data-item:nth-child(1) .data-value').textContent = `${elevation.toFixed(2)} m`;
          document.querySelector('.data-grid .data-item:nth-child(2) .data-value').textContent = `${distanceToCoast.toFixed(2)} km`;
          document.querySelector('.data-grid .data-item:nth-child(3) .data-value').textContent = conditions.climate;
          document.querySelector('.data-grid .data-item:nth-child(4) .data-value').textContent = conditions.vegetation;

          // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
          let popupContent = `
            <div class="popup-container">
              <div class="popup-header">
                <div class="popup-title">ğŸ”¬ ${currentLang === 'en' ? 'Geospatial Analysis' : 'Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ'}</div>
                <div class="popup-subtitle">${currentLang === 'en' ? 'AI-powered spatial intelligence' : 'Ø°ÙƒØ§Ø¡ Ù…ÙƒØ§Ù†ÙŠ Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ'}</div>
              </div>
              <div class="popup-body">
                <div class="data-section">
                  <div class="section-title">ğŸ“ ${currentLang === 'en' ? 'Basic Geospatial Coordinates' : 'Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©'}</div>
                  <div class="coordinates">
                    <div class="coord-item">${currentLang === 'en' ? 'Latitude' : 'Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶'}: <b>${lat}</b></div>
                    <div class="coord-item">${currentLang === 'en' ? 'Longitude' : 'Ø®Ø· Ø§Ù„Ø·ÙˆÙ„'}: <b>${lng}</b></div>
                  </div>
                  <div class="data-item-detailed">
                    <div class="data-label-detailed">â›°ï¸ ${currentLang === 'en' ? 'Altitude' : 'Ø§Ù„Ø§Ø±ØªÙØ§Ø¹'}</div>
                    <div class="data-value-detailed"><b>${elevation.toFixed(2)} m</b></div>
                  </div>
                  <div class="data-item-detailed">
                    <div class="data-label-detailed">ğŸŒŠ ${currentLang === 'en' ? 'Distance to Coast' : 'Ø§Ù„Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø³Ø§Ø­Ù„'}</div>
                    <div class="data-value-detailed"><b>${distanceToCoast.toFixed(2)} km</b></div>
                  </div>
                  <div class="data-item-detailed">
                    <div class="data-label-detailed">â° ${currentLang === 'en' ? 'Timezone' : 'Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©'}</div>
                    <div class="data-value-detailed"><b>Africa/Casablanca</b><br/>
                    ${currentLang === 'en' ? 'Time' : 'Ø§Ù„ÙˆÙ‚Øª'}: ${new Date().toLocaleTimeString('en-US')}<br/>
                    ${currentLang === 'en' ? 'Date' : 'Ø§Ù„ØªØ§Ø±ÙŠØ®'}: ${new Date().toLocaleDateString('en-US')}
                    </div>
                  </div>
                </div>

                <div class="data-section">
                  <div class="section-title">ğŸŒ¿ ${currentLang === 'en' ? 'Environmental Analysis' : 'Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ¦ÙŠ'}</div>
                  <div class="data-item-detailed">
                    <div class="data-label-detailed">ğŸŒ¤ï¸ ${currentLang === 'en' ? 'Climate' : 'Ø§Ù„Ù…Ù†Ø§Ø®'}</div>
                    <div class="data-value-detailed"><b>${conditions.climate}</b></div>
                  </div>
                  <div class="data-item-detailed">
                    <div class="data-label-detailed">ğŸŒ³ ${currentLang === 'en' ? 'Vegetation' : 'Ø§Ù„ØºØ·Ø§Ø¡ Ø§Ù„Ù†Ø¨Ø§ØªÙŠ'}</div>
                    <div class="data-value-detailed"><b>${conditions.vegetation}</b></div>
                  </div>
                  <div class="data-item-detailed">
                    <div class="data-label-detailed">ğŸ’§ ${currentLang === 'en' ? 'Water Resources' : 'Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ø§Ø¦ÙŠØ©'}</div>
                    <div class="data-value-detailed"><b>${conditions.water}</b></div>
                  </div>
                  <div class="data-item-detailed">
                    <div class="data-label-detailed">ğŸŒ± ${currentLang === 'en' ? 'Soil Type' : 'Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø©'}</div>
                    <div class="data-value-detailed"><b>${conditions.soil}</b></div>
                  </div>
          `;

          if (conditions.hazards.length > 0) {
            popupContent += `
              <div class="data-item-detailed">
                <div class="data-label-detailed">âš ï¸ ${currentLang === 'en' ? 'Environmental Hazards' : 'Ø§Ù„Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø¨ÙŠØ¦ÙŠØ©'}</div>
                <div class="data-value-detailed">
                  ${conditions.hazards.map(hazard => `â€¢ ${hazard}`).join('<br>')}
                </div>
              </div>
            `;
          }

          popupContent += `
                </div>

                <div class="data-section">
                  <div class="section-title">ğŸŒ ${currentLang === 'en' ? 'Geographical Information' : 'Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©'}</div>
                  <div class="data-item-detailed">
                    <div class="data-label-detailed">ğŸ“Œ ${currentLang === 'en' ? 'Location' : 'Ø§Ù„Ù…ÙˆÙ‚Ø¹'}</div>
                    <div class="data-value-detailed"><b>${currentLang === 'en' ? 'Unknown Location, Morocco' : 'Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØŒ Ø§Ù„Ù…ØºØ±Ø¨'}</b></div>
                  </div>
                  <div class="data-item-detailed">
                    <div class="data-label-detailed">ğŸŒ ${currentLang === 'en' ? 'Country' : 'Ø§Ù„Ø¯ÙˆÙ„Ø©'}</div>
                    <div class="data-value-detailed"><b>${currentLang === 'en' ? 'Morocco' : 'Ø§Ù„Ù…ØºØ±Ø¨'}</b></div>
                  </div>
                </div>

                <div class="data-section">
                  <div class="section-title">ğŸ“Š ${currentLang === 'en' ? 'Scientific Analysis' : 'Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù„Ù…ÙŠ'}</div>
                  <div class="scientific-tools">
                    <div class="tool-card">
                      <div class="tool-title">${currentLang === 'en' ? 'Estimated Temperature' : 'Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ù‚Ø¯Ø±Ø©'}</div>
                      <div class="tool-value">${(25 - (elevation/100)).toFixed(1)}</div>
                      <div class="tool-value" style="font-size: 0.8rem;">Â°C</div>
                    </div>
                    <div class="tool-card">
                      <div class="tool-title">${currentLang === 'en' ? 'Relative Humidity' : 'Ø§Ù„Ø±Ø·ÙˆØ¨Ø© Ø§Ù„Ù†Ø³Ø¨ÙŠØ©'}</div>
                      <div class="tool-value">${Math.floor(70 - (distanceToCoast/10))}</div>
                      <div class="tool-value" style="font-size: 0.8rem;">%</div>
                    </div>
                    <div class="tool-card">
                      <div class="tool-title">${currentLang === 'en' ? 'Sunlight Exposure' : 'Ø§Ù„ØªØ¹Ø±Ø¶ Ù„Ù„Ø´Ù…Ø³'}</div>
                      <div class="tool-value">${Math.floor(8 - (elevation/500))}</div>
                      <div class="tool-value" style="font-size: 0.8rem;">${currentLang === 'en' ? 'hrs/day' : 'Ø³Ø§Ø¹Ø©/ÙŠÙˆÙ…'}</div>
                    </div>
                    <div class="tool-card">
                      <div class="tool-title">${currentLang === 'en' ? 'Wind Speed' : 'Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙŠØ§Ø­'}</div>
                      <div class="tool-value">${Math.floor(15 + (elevation/100))}</div>
                      <div class="tool-value" style="font-size: 0.8rem;">${currentLang === 'en' ? 'km/h' : 'ÙƒÙ…/Ø³'}</div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="popup-footer">
                <div>${currentLang === 'en' ? 'Analysis completed at' : 'Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙÙŠ'} ${new Date().toLocaleString('en-US')}</div>
                <div class="action-buttons">
                  <button class="btn btn-outline">${currentLang === 'en' ? 'Close' : 'Ø¥ØºÙ„Ø§Ù‚'}</button>
                </div>
              </div>
            </div>
          `;

          popup.setContent(popupContent);

          // Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
          popup.getElement().querySelector('.btn-outline').addEventListener('click', () => {
            map.closePopup();
          });

        } catch (error) {
          console.error("Error:", error);
          popup.setContent(`
            <div class="popup-container">
              <div class="popup-header">
                <div class="popup-title">âŒ ${currentLang === 'en' ? 'Analysis Error' : 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„'}</div>
              </div>
              <div class="popup-body">
                <div class="error">
                  ${currentLang === 'en' ? 'Failed to complete geospatial analysis for this location.' : 'ÙØ´Ù„ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹.'}<br/>
                  ${currentLang === 'en' ? 'Please try another location.' : 'ÙŠØ±Ø¬Ù‰ ØªØ¬Ø±Ø¨Ø© Ù…ÙˆÙ‚Ø¹ Ø¢Ø®Ø±.'}
                </div>
              </div>
              <div class="popup-footer">
                <div>${currentLang === 'en' ? 'Real-time analysis' : 'ØªØ­Ù„ÙŠÙ„ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ'}</div>
                <div class="action-buttons">
                  <button class="btn btn-outline">${currentLang === 'en' ? 'Close' : 'Ø¥ØºÙ„Ø§Ù‚'}</button>
                </div>
              </div>
            </div>
          `);

          popup.getElement().querySelector('.btn-outline').addEventListener('click', () => {
            map.closePopup();
          });
        }
      }, 1500); // ØªØ£Ø®ÙŠØ± Ù„Ù…Ø­Ø§ÙƒØ§Ø© ÙˆÙ‚Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
    });

    // Search functionality
    document.getElementById('searchInput').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        const query = this.value.trim();
        if (query) {
          // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø¨Ø­Ø«
          alert(`${currentLang === 'en' ? 'Search functionality would locate:' : 'Ø³ØªÙ‚ÙˆÙ… ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¨Ø­Ø« Ø¨ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹:'} ${query}`);
        }
      }
    });
  </script>
</body>
</html>
